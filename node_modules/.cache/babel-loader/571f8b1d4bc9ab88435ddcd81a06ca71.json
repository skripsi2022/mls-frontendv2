{"ast":null,"code":"import axios from 'axios';\nexport default {\n  name: 'Auth.IndexView',\n\n  data() {\n    return {\n      //state loggedIn with localStorage\n      loggedIn: localStorage.getItem('loggedIn'),\n      //state token\n      token: localStorage.getItem('token'),\n      //state user\n      user: [],\n      //state validation\n      validation: [],\n      //state login failed\n      loginFailed: null\n    };\n  },\n\n  methods: {\n    login() {\n      if (this.user.email && this.user.password) {\n        axios.get('/sanctum/csrf-cookie').then(response => {\n          //debug cookie\n          console.log(response);\n          axios.post('/api/login', {\n            email: this.user.email,\n            password: this.user.password\n          }).then(res => {\n            //debug user login\n            console.log(res);\n\n            if (res.data.success) {\n              //set localStorage User\n              localStorage.setItem('user', JSON.stringify(res.data.user));\n              localStorage.setItem('name', JSON.stringify(res.data.user)); //set localStorage\n\n              localStorage.setItem(\"loggedIn\", \"true\"); //set localStorage Token\n\n              localStorage.setItem(\"token\", res.data.token); //set localStorage ID\n\n              localStorage.setItem(\"id\", res.data.user.id); //set localStorage Role\n\n              localStorage.setItem(\"role\", res.data.role); //change state\n\n              this.loggedIn = true;\n              let loginType = res.data.user.role;\n\n              if (loginType === 'Guru') {\n                //redirect dashboard\n                return this.$router.push({\n                  name: 'dashboard.index'\n                });\n              } else if (loginType === 'Admin') {\n                //redirect dashboard\n                return this.$router.push({\n                  name: 'dashboard.index'\n                });\n              }\n            } else {\n              //set state login failed\n              this.loginFailed = true;\n            }\n          }).catch(error => {\n            this.loginFailed = true;\n            console.log(error);\n          });\n        });\n      }\n\n      this.validation = [];\n\n      if (!this.user.email) {\n        this.validation.email = true;\n      }\n\n      if (!this.user.password) {\n        this.validation.password = true;\n      }\n    }\n\n  },\n\n  //check user already logged in\n  mounted() {\n    if (this.loggedIn) {\n      return this.$router.push({\n        name: 'dashboard.index'\n      });\n    }\n  }\n\n};","map":{"version":3,"mappings":"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","names":["axios","name","data","loggedIn","localStorage","getItem","token","user","validation","loginFailed","methods","login","email","password","get","then","response","console","log","post","res","success","setItem","JSON","stringify","id","role","loginType","$router","push","catch","error","mounted"],"sourceRoot":"","sources":["E:\\KULIAH\\SEKERIPSI\\PROGRESS\\OTW\\FRONTEND\\mls-frontend_v2\\src\\views\\Auth\\IndexView.vue"],"sourcesContent":["<template>\r\n    <div class=\"auth-full-height container d-flex flex-column justify-content-center\">\r\n        <div class=\"row justify-content-center\">\r\n            <div class=\"col-md-9\">\r\n                <div class=\"card row mx-0 flex-row overflow-hidden\">\r\n                    <div class=\"col-md-4 bg-size-cover d-flex align-items-center p-4\" style=\"background-image: url('assets/images/others/bg-2.jpg');\">\r\n                        <div>\r\n                            <div class=\"mb-5\">\r\n                                <div class=\"logo\">\r\n                                    <img alt=\"logo\" class=\"img-fluid\" src=\"assets/images/logo/logo-white.png\" style=\"height: 50px;\">\r\n                                </div>\r\n                            </div>\r\n                            <h3 class=\"text-white\">Learning System Management 2.0 </h3>\r\n                            <p class=\"text-white mt-4 mb-5 o-75\">Cloud Based Learning System with Proxmox VE - We Made Simple Cloud Computing Service.</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col-md-8 px-0\">\r\n                        <div class=\"card-body\">\r\n                            <div class=\"my-5 mx-auto\" style=\"max-width: 350px;\">\r\n                                <div class=\"mb-3\">\r\n                                    <h3>Login</h3>\r\n                                </div>\r\n                                <form @submit.prevent=\"login\">\r\n                                    <div class=\"form-group mb-3\">\r\n                                        <label class=\"form-label\">Email</label>\r\n                                        <input class=\"form-control\" v-model=\"user.email\" />\r\n                                         <div v-if=\"validation.email\" class=\"text-danger\">\r\n                                            Masukkan Email !\r\n                                         </div>\r\n                                    </div>\r\n                                   \r\n                                    <div class=\"mb-3\">\r\n                                        <label class=\"form-label d-flex justify-content-between\">\r\n                                            <span>Password</span>\r\n                                            <a href=\"\" class=\"text-primary font\">Forget Password?</a>\r\n                                        </label>\r\n                                        <div class=\"form-group input-affix flex-column\">\r\n                                            <label class=\"d-none\">Password</label>\r\n                                            <input formcontrolname=\"password\" class=\"form-control\" type=\"password\" v-model=\"user.password\">\r\n                                            <i class=\"suffix-icon feather cursor-pointer text-dark icon-eye\" ng-reflect-ng-class=\"icon-eye\"></i>\r\n                                        </div>\r\n                                         <div v-if=\"validation.password\" class=\"text-danger\">\r\n                                            Masukkan Password !\r\n                                        </div>\r\n                                    </div>\r\n                                    <button type=\"submit\" class=\"btn btn-primary w-100\">Log In</button>\r\n                                </form>\r\n                               <div v-if=\"validation.password\" class=\"divider\">\r\n                                    <span class=\"divider-text text-danger\">Password atau Email tidak sesuai !</span>\r\n                                </div>\r\n                                 <!-- <div class=\"row\">\r\n                                    <div class=\"col px-1\">\r\n                                        <button class=\"btn btn-outline-secondary w-100\">\r\n                                            <img src=\"assets/images/thumbs/thumb-1.png\" alt=\"\" style=\"max-width: 20px;\">\r\n                                        </button>\r\n                                    </div>\r\n                                    <div class=\"col px-1\">\r\n                                        <button class=\"btn btn-outline-secondary w-100\">\r\n                                            <img src=\"assets/images/thumbs/thumb-2.png\" alt=\"\" style=\"max-width: 20px;\">\r\n                                        </button>\r\n                                    </div>\r\n                                    <div class=\"col px-1\">\r\n                                        <button class=\"btn btn-outline-secondary w-100\">\r\n                                            <img src=\"assets/images/thumbs/thumb-3.png\" alt=\"\" style=\"max-width: 20px;\">\r\n                                        </button>\r\n                                    </div>\r\n                                </div> -->\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\n    import axios from 'axios'\r\n\r\n    export default {\r\n        name: 'Auth.IndexView',\r\n\r\n        data() {\r\n            return {\r\n                //state loggedIn with localStorage\r\n                loggedIn: localStorage.getItem('loggedIn'),\r\n                //state token\r\n                token: localStorage.getItem('token'),\r\n                //state user\r\n                user: [],\r\n                //state validation\r\n                validation: [],\r\n                //state login failed\r\n                loginFailed: null\r\n            }\r\n        },\r\n        methods: {\r\n\r\n            login() {\r\n                if (this.user.email && this.user.password) {\r\n                    axios.get('/sanctum/csrf-cookie')\r\n                        .then(response => {\r\n\r\n                            //debug cookie\r\n                            console.log(response)\r\n\r\n                            axios.post('/api/login', {\r\n                                email: this.user.email,\r\n                                password: this.user.password\r\n                            }).then(res => {\r\n\r\n                                //debug user login\r\n                                console.log(res)\r\n\r\n                                if (res.data.success) {\r\n                                    //set localStorage User\r\n                                    localStorage.setItem('user', JSON.stringify(res.data.user))\r\n\r\n                                    localStorage.setItem('name', JSON.stringify(res.data.user))\r\n\r\n                                    //set localStorage\r\n                                    localStorage.setItem(\"loggedIn\", \"true\")\r\n\r\n                                    //set localStorage Token\r\n                                    localStorage.setItem(\"token\", res.data.token)\r\n\r\n                                    //set localStorage ID\r\n                                    localStorage.setItem(\"id\", res.data.user.id)\r\n\r\n                                    //set localStorage Role\r\n                                    localStorage.setItem(\"role\", res.data.role)\r\n                                    \r\n                                    //change state\r\n                                    this.loggedIn = true\r\n\r\n                                    let loginType = res.data.user.role\r\n                                    \r\n                                    if(loginType === 'Guru'){\r\n                                        //redirect dashboard\r\n                                        return this.$router.push({ name: 'dashboard.index' })\r\n                                    } else if(loginType === 'Admin'){\r\n                                        //redirect dashboard\r\n                                        return this.$router.push({ name: 'dashboard.index' })\r\n                                    }\r\n\r\n                                } else {\r\n                                    //set state login failed\r\n                                    this.loginFailed = true\r\n                                }\r\n\r\n                            }).catch(error => {\r\n                                this.loginFailed = true\r\n                                console.log(error)\r\n                            })\r\n\r\n                        })\r\n                }\r\n\r\n                this.validation = []\r\n\r\n                if (!this.user.email) {\r\n                    this.validation.email = true\r\n                }\r\n\r\n                if (!this.user.password) {\r\n                    this.validation.password = true\r\n                }\r\n\r\n            }\r\n        },\r\n\r\n        //check user already logged in\r\n        mounted() {\r\n            if (this.loggedIn) {\r\n                return this.$router.push({ name: 'dashboard.index' })\r\n            }\r\n        }\r\n    }\r\n</script>"]},"metadata":{},"sourceType":"module"}